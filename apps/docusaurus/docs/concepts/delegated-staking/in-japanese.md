---
title: "日本語 (In Japanese)"
---

import ThemedImage from '@theme/ThemedImage';
import useBaseUrl from '@docusaurus/useBaseUrl';

# 委任ステーキング

## Aptos ブロックチェーンにおける委任ステーキング

:::tip
[ステーキング](../staking/in-japanese.md) を先に読むことを強くお勧めします。
:::

委任ステーキングはステーキングプロトコルの拡張です。委任プールは、委任者からステークを収集し、委任者に代わってバリデータに接続されたネイティブステークプールにステークを追加できるエンティティにステーク所有者を抽象化したものです。これにより、複数のエンティティが、バリデータがバリデータセットに参加するための最小要件を達成するステークプールを形成できるようになります。委任者は非アクティブなプールにステークを追加できますが、委任プールはアクティブになるまで報酬を獲得できません。

:::danger **委任プールには承認がなく、誰でもステークを追加できます。委任プールは、作成後にステークプールに変更したり、その逆はできませんが、バリデータセットから削除したり、アセットを取り消したりすることはできます。ステークプールの詳細については、[ステーキング](../staking/in-japanese.md) を参照してください。**
:::

委任プールの完全なスマートコントラクトについては、 [delegation_pool.move](https://github.com/aptos-labs/aptos-core/blob/main/aptos-move/framework/aptos-framework/sources/delegation_pool.move) を参照してください。

ステークプールとは異なり、委任プールはゼロステークで初期化できます。初期化されると、委任ステークプールはリソースアカウントを介して間接的に所有されます。このアカウントは、委任者に代わってステーク管理操作 (追加、ロック解除、再アクティブ化、引き出し) を転送することによって、基盤となるステークプールのステークを管理します。しかし、リソースアカウントには直接アクセスしたり、外部から所有したりすることはできません。

全リストについては、 [Delegation Pool Operations](../../nodes/validator-node/operator/delegation-pool-operations.md) を参照してください。

![image](https://user-images.githubusercontent.com/120680608/234953723-ae6cc89e-76d8-4014-89f3-ec8799c7b281.png)

エンティティ種別には4種類あります。

- 所有者
- オペレータ
- 投票者
- 委任者

このモデルを使用すると、所有者はバリデータを実行するために Aptos ブロックチェーンにステークする必要がありません。

[Aptos ブロックチェーンにおけるバリデーション方法](../staking/in-japanese.md#aptos-ブロックチェーンにおけるバリデーション)

### 所有者

委任プールの所有者は次のことができます。

1. 委任プールを作成する
2. 委任プールにオペレーターを割り当てる
3. 委任プールのオペレーター手数料率を設定する
4. 代表団に投票者を割り当てる

### オペレータ

ノードオペレータは、バリデータノードを実行するためにプール所有者によって割り当てられます。オペレーターには次のことができます。

1. 委任プールが100万 APT に達したら、バリデータセットに参加または離脱する
2. 検証機能の実行
3. コンセンサスキーとネットワークアドレスを変更する。 コンセンサスキーは、バリデータ コンセンサスプロセスに参加するため、つまりブロックを投票して提案するために使用されます。このキーが侵害された場合に備えて、オペレータはこのキーを変更 (ローテーション) することができます。

オペレーターは、各エポックの終了時に報酬として自動的に分配されるコミッションを受け取ります。

### 投票者

所有者は投票者を指定できます。これにより、有権者はガバナンスに参加できるようになります。 投票者は投票者キーを使用して、トランザクションのガバナンス投票に署名します。

:::tip ガバナンス
このドキュメントではステーキングについて説明しています。 所有者-投票者モデルを使用して Aptos オンチェーン ガバナンスに参加する方法については、 [Governance](../governance.md) を参照してください。
:::

### 委任者

委任者とは、委任プールにステークがある人を指します。委任者は、オペレータの手数料を差し引いたステークから報酬を獲得します。委任者は次のことができます。

1. ステーク追加
2. ステークのアンロック
3. ステークの再アクティブ化
4. ステークの引き出し

## バリデータフロー

:::tip 委任プール操作
以下のフローを実行するための正しいコマンドの順番については、 [Delegation pool operations](../../nodes/validator-node/operator/delegation-pool-operations.md) を参照してください。
:::

1. [オペレーターがバリデータノードをデプロイする](../../nodes/validator-node/operator/running-validator-node/index.md)
2. [コマンドを実行して委任プールアドレスを取得する](../../nodes/validator-node/operator/delegation-pool-operations.md#initialize-a-delegation-pool)
3. [オペレータが、手順 2 で取得したプールアドレスを使用してネットワークに接続する](../../nodes/validator-node/operator/connect-to-aptos-network.md)
4. [所有者は委任プールを初期化し、オペレータを設定する](../../nodes/validator-node/operator/delegation-pool-operations.md#initialize-a-delegation-pool)
5. 委任者はいつでもステークを追加できる
6. 委任プールが100万 APT に達すると、オペレータは Aptos ノード join-validator-set を呼び出して、アクティブなバリデーターセットに参加できる。 変更は次のエポックで有効になる。
7. バリデータは検証 (リーダーバリデータとしてブロックを提案) し、報酬を得る。 報酬はステーク額に比例して委任者に分配される。 ステークは一定期間（ガバナンスによって設定）自動的にロックされ、有効期限が切れると自動的に更新される。
8. オペレータがコンセンサスキーまたはバリデータネットワークアドレスを更新したい場合は、いつでも Aptos ノード update-consensus-key または aptos ノード update-validator-network-addresses を呼び出すことができる。ステークへの変更と同様に、コンセンサスキーまたはバリデータネットワークアドレスへの変更は、次のエポックでのみ有効になる。
9. 委任者はいつでもステークのロックを解除するようリクエストできる。ただし、彼らのステークは、委任プールのロックアップが期限切れになった場合にのみ引き出し可能になる。
10. バリデータは、 Aptos ノードの leave-validator-set を呼び出してバリデータセットを明示的に残すか、ステークが必要な最小値を下回った場合、エポックの終わりに削除される。

## バリデータセットへの参加

Aptos ネットワーク上で委任バリデータノードとして参加するには、次のようにします。

1. オペレーターはバリデータノードを実行し、オンチェーンバリデータネットワークアドレスを構成し、コンセンサスキーをローテーションする。
2. 所有者が委任プールを初期化する。
3. バリデータノードは、委任プールがアクティブになるまで同期できない。委任プールは、100万 APT に達するとアクティブになる。
4. オペレータは検証して報酬を獲得する。
5. ステーク プールは一定期間 (Aptos ガバナンスによって設定) 自動的にロックされ、有効期限が切れると自動的に更新される。 コミッションは報酬としてオペレーターに自動的に分配される。 オペレータはいつでもステークのロックを解除できるが、委任プールのロックアップ期間が終了するまで引き出すことはできない。
6. オペレータは、そのバリデータがアクティブになる前に、新しいエポックが開始するまで待つ必要がある。

:::tip バリデータセットへの参加
バリデーター セットに参加する方法の詳細な手順については、[Joining Validator Set](../../nodes/validator-node/operator/connect-to-aptos-network.md#join-the-validator-set) を参照してください。
:::

### 自動ロックアップの期間

オペレータがバリデータセットに参加すると、委任プールのステークは、 Aptos ガバナンスによって設定された一定期間自動的にロックアップされます。 委任者は、委任プールのロックアップ サイクルに従います。

### 自動ロックアップの更新

ロックアップ期間が終了すると、ロックアップ期間は自動的に更新されるため、バリデータは引き続き検証して報酬を受け取ることができます。

### ステークのアンロック

委任者はいつでもステークのロックを解除することができます。ただし、現在のロックアップが期限切れになった場合にのみ、ステークされたコインを引き出すことができます。ステークされたコインが出金可能になるまで、報酬を獲得し続けることができます。

### ロックアップのリセット

ロックアップはリセットできません。

## 報酬

委任されたステーキングの報酬は次を使用して計算されます。

1. 年間パーセント利回り (APY) rewards_rate つまり、報酬は現在のステーク額の複利として発生します。
2. 委任者ステーク
3. [バリデータ報酬パフォーマンス](../../concepts/staking/in-japanese.md#報酬の式)

[Computing delegation pool rewards](../../nodes/validator-node/operator/delegation-pool-operations.md#compute-delegation-pool-rewards-earned) を参照してください。
