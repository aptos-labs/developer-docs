---
title: "バリデーターノードの概要"
---

import { Callout } from "nextra/components";

# バリデーターノードの概要

Aptosノードは、Aptosブロックチェーンの状態を追跡するAptosエコシステムのエンティティです。クライアントはAptosノードを介してブロックチェーンと対話します。ノードには2つのタイプがあります：

- バリデーターノード
- [フルノード](fullnodes.mdx)

各Aptosノードはいくつかの論理コンポーネントで構成されています：

- [REST APIサービス](../glossary.mdx#rest-api-service)
- [メモリプール](#mempool)
- [コンセンサス（フルノードでは無効）](#consensus)
- [実行](#execution)
- [仮想マシン](#virtual-machine-vm)
- [ストレージ](#storage)
- [ステート同期](#state-synchronizer)

[Aptos-core](../glossary.mdx#aptos-core)ソフトウェアは、バリデーターノードまたはフルノードとして動作するように設定できます。

## 概要

トランザクションがAptosブロックチェーンに送信されると、バリデーターノードは分散[コンセンサスプロトコル](../glossary.mdx#consensus-protocol)を実行し、トランザクションを実行し、トランザクションとその実行結果をブロックチェーンに保存します。バリデーターノードは、どのトランザクションをブロックチェーンに追加し、どの順序で追加するかを決定します。

Aptosブロックチェーンは、ビザンチン障害耐性（BFT）コンセンサスプロトコルを使用して、バリデーターノードが確定したトランザクションの台帳とその実行結果について合意します。バリデーターノードはこれらのトランザクションを処理し、ローカルのブロックチェーンデータベースのコピーに含めます。これは、最新のバリデーターノードが常にブロックチェーンの現在の[状態](../glossary.mdx#state)のコピーをローカルに保持していることを意味します。

バリデーターノードは、プライベートネットワークを介して他のバリデーターノードと直接通信します。[フルノード](fullnodes.mdx)は、確定したトランザクション履歴の外部検証および/または配信リソースです。フルノードはピアからトランザクションを受信し、ローカルで再実行することができます（バリデーターがトランザクションを実行するのと同じ方法で）。フルノードは再実行されたトランザクションの結果をローカルストレージに保存します。これにより、バリデーターによる不正行為に異議を唱え、ブロックチェーン履歴の書き換えや変更の試みがあった場合に証拠を提供することができます。これは、バリデーターの不正行為や共謀を軽減するのに役立ちます。

<Callout type="info">
AptosBFTコンセンサスプロトコルは、最大で3分の1の悪意のあるバリデーターノードに対する障害耐性を提供します。
</Callout>

## バリデーターノードのコンポーネント

![](/docs/validator.svg)

### メモリプール

メモリプールは、各ノード内のコンポーネントで、ブロックチェーンに送信されたが、まだ合意されていない、または実行されていないトランザクションのインメモリバッファを保持します。このバッファはバリデーターノードとフルノード間で複製されます。

フルノードのJSON-RPCサービスは、トランザクションをバリデーターノードのメモリプールに送信します。メモリプールは、トランザクションの有効性を確認し、DOS攻撃から保護するためにさまざまなチェックを実行します。新しいトランザクションが初期検証に合格してメモリプールに追加されると、ネットワーク内の他のバリデーターノードのメモリプールに配信されます。

バリデーターノードが一時的にコンセンサスプロトコルのリーダーになると、コンセンサスはメモリプールからトランザクションを取得し、新しいトランザクションブロックを提案します。このブロックは他のバリデーターにブロードキャストされ、ブロック内のすべてのトランザクションの完全な順序付けが含まれています。各バリデーターはブロックを実行し、新しいブロック提案を受け入れるかどうかについて投票を提出します。

### コンセンサス

コンセンサスは、トランザクションブロックの順序付けを担当し、ネットワーク内の他のバリデーターノードとコンセンサスプロトコルに参加することで実行結果に合意するコンポーネントです。

### 実行

実行は、トランザクションブロックの実行を調整し、一時的な状態を維持するコンポーネントです。コンセンサスはこの一時的な状態に対して投票します。実行は、コンセンサスがブロックを分散データベースにコミットするまで、実行結果のインメモリ表現を維持します。実行は仮想マシンを使用してトランザクションを実行します。実行は、システムの入力（トランザクションで表される）、ストレージ（永続性レイヤーを提供）、および仮想マシン（実行用）の間の接着層として機能します。

### 仮想マシン（VM）

仮想マシン（VM）は、各トランザクション内のMoveプログラムを実行し、実行結果を決定するために使用されます。ノードのメモリプールはVMを使用してトランザクションの検証チェックを実行し、実行はVMを使用してトランザクションを実行します。

### ストレージ

ストレージコンポーネントは、合意されたトランザクションブロックとその実行結果をローカルデータベースに永続化するために使用されます。

### ステート同期

ノードはステート同期コンポーネントを使用して、ブロックチェーンの最新の状態に「追いつき」、最新の状態を維持します。
