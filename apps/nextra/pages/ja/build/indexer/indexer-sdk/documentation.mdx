---
title: "ドキュメント"
---
import { ThemedImage } from '@components/index';

# ドキュメント

## Indexer SDKのアーキテクチャ

Aptosのインデックススタックでは、プロセッサーはブロックチェーンから特定のデータのサブセットをインデックス化し、そのデータを外部データベースに書き込みます。

各プロセッサーは以下の一般的なフローに従います：

1. [トランザクションストリーム](../txn-stream.mdx)からトランザクションのストリームを受信
2. トランザクションから関連データを抽出し、標準化されたスキーマに変換
3. 変換されたデータをデータベースに保存
4. 処理済みのトランザクションバージョンを追跡

Indexer SDKを使用すると、独立したステップの有向グラフとしてプロセッサーを記述できます。
各`Step`には入力と出力があり、各`Step`の出力は[Kanalチャネル](https://github.com/fereidani/kanal)を介して次の`Step`の入力に接続されます。

<center>
  <ThemedImage
    alt="Indexer SDKカスタムプロセッサーのアーキテクチャ"
    sources={{
      light: '/docs/indexer-custom-processor-light.svg',
      dark: '/docs/indexer-custom-processor-dark.svg',
    }}
  />
</center>

## Indexer SDKを使用するタイミング
Indexer SDKは、カスタムコントラクトをインデックス化したい場合や、[Indexer API](../aptos-hosted.mdx)で利用できない新しい種類のデータが必要だと気付いた場合に役立ちます。

Indexer SDKでカスタムプロセッサーを作成する一般的なフローは以下の通りです：
1. データベーススキーマを定義する
2. 新しいプロセッサーを作成する
3. ストレージスキーマにデータを抽出・変換する`Step`を作成する
2. ステップを追加・接続してプロセッサーをカスタマイズする
3. プロセッサーを実行し、データベースにインデックス化されたデータを確認する

## Indexer SDKのメリット
Indexer SDKのアーキテクチャは、以下のような方法でカスタムプロセッサーの作成を簡素化します：

1. プロセッサー間で`Step`の実装を再利用でき、一般的なデータ抽出ロジックの重複を減らすことができます。
2. SDKは処理されたトランザクション数などの基本的なパフォーマンスメトリクスを各`Step`で収集し、プロセッサーのサブコンポーネントの可観測性を可能にします。
3. 各`Step`は独立しているため、他の部分を壊すことなくプロセッサーの一部を安全にカスタマイズできます。
例えば、データの前処理/後処理やデータ書き込みのバッチ処理を行うための追加の`Step`を追加できます。また、各`Step`はプロセッサーの他の部分から独立してテストすることができます。
