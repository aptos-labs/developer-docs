# デバッグ

Moveプログラムのデバッグには、主に以下の方法があります：

## デバッグ情報の出力

テストを書く際に、デバッグ情報やスタックトレースを出力すると便利です。`aptos move test`を使用する際に、以下の関数を使用できます：

- `debug::print` - 値を出力します
- `debug::print_stack_trace` - スタックトレースを出力します

### 使用例

以下は、デバッグ出力を使用する基本的な例です：

```move
use std::debug;

#[test]
fun test_with_debug() {
    let x = 42;
    debug::print(&x); // 値を出力
    debug::print_stack_trace(); // 現在のスタックトレースを出力
}
```

### デバッグ出力の確認方法

デバッグ出力を確認するには：

1. テストファイルを含むMoveパッケージを作成します
2. `aptos move test`コマンドを実行します

## デバッグのベストプラクティス

1. **段階的なデバッグ**
   - 複雑な関数は小さな部分に分割してテスト
   - 各ステップで中間値を確認

2. **アサーションの活用**
   - `assert!`マクロを使用して想定される条件を確認
   - エラーメッセージを具体的に記述

3. **テストカバレッジの確認**
   - `aptos move test --coverage`を使用してテストカバレッジを確認
   - 重要なパスが全てテストされていることを確認

## トラブルシューティング

一般的な問題とその解決方法：

1. **実行時エラー**
   - エラーメッセージを注意深く読む
   - `debug::print`を使用して値を確認
   - スタックトレースで問題の箇所を特定

2. **型エラー**
   - 変数の型を`debug::print`で確認
   - ジェネリック型パラメータが正しいか確認

3. **リソースの問題**
   - リソースの移動と借用を追跡
   - グローバルストレージの操作を確認

## 高度なデバッグ機能

### Move Prover

より高度な検証が必要な場合は、Move Proverを使用できます：

```bash
aptos move prove
```

これにより：
- 形式的な仕様に対するコードの検証
- 潜在的なバグの早期発見
- セキュリティ保証の強化

が可能になります。 