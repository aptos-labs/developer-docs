import { Callout, Steps } from 'nextra/components'

# é€šè¿‡ Aptos CLI ä½¿ç”¨ç¡¬ä»¶é’±åŒ…

ä½¿ç”¨ç¡¬ä»¶é’±åŒ…(å¦‚ Ledger)æ˜¯åœ¨ `mainnet` ä¸Šç­¾ç½²äº¤æ˜“æœ€å®‰å…¨çš„æ–¹å¼ï¼Œå› ä¸ºä½ çš„ç§é’¥æ°¸è¿œä¸ä¼šç¦»å¼€è®¾å¤‡ã€‚

<Callout type="warning">
`Ledger Nano S` çš„å†…å­˜æœ‰é™ï¼Œå¯èƒ½æ— æ³•åœ¨ Aptos ä¸Šç­¾ç½²è®¸å¤šäº¤æ˜“ã€‚å¦‚æœä½ è¯•å›¾ç­¾ç½²çš„äº¤æ˜“å¯¹ä½ çš„è®¾å¤‡æ¥è¯´å¤ªå¤§ï¼Œä½ ä¼šæ”¶åˆ°é”™è¯¯ `Wrong raw transaction length`ã€‚
</Callout>

## åˆå§‹è®¾ç½®

ä½ éœ€è¦ä¸º Aptos CLI å’Œ Ledger è®¾å¤‡è¿›è¡Œä¸€äº›é…ç½®æ­¥éª¤æ‰èƒ½ç­¾ç½²äº¤æ˜“ã€‚
<Steps>

### ç¡®ä¿å·²å®‰è£… Aptos CLIã€‚
   å¦‚æœä½ è¿˜æ²¡æœ‰å®‰è£… Aptos CLIï¼Œå¯ä»¥æŒ‰ç…§[è¿™äº›æ­¥éª¤](../../cli.mdx)è¿›è¡Œå®‰è£…ã€‚

### ç¡®ä¿å·²å®Œæˆ Ledger è®¾å¤‡çš„åŸºæœ¬è®¾ç½®ã€‚
   ä½ å¯ä»¥åœ¨ [Ledger ç½‘ç«™](https://www.ledger.com/)ä¸Šæ‰¾åˆ°è¿™äº›æ­¥éª¤ã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯ [Ledger Nano X](https://support.ledger.com/hc/en-us/articles/360018784134-Set-up-your-Ledger-Nano-X?docs=true) çš„è®¾ç½®è¯´æ˜ã€‚
### å°† Ledger è®¾å¤‡æ’å…¥è®¡ç®—æœºã€‚
### æŒ‰ç…§[æœ¬æŒ‡å—](https://support.ledger.com/hc/en-us/articles/7326502672285-Aptos-APT?docs=true)åœ¨ Ledger è®¾å¤‡ä¸Šå®‰è£… Aptos åº”ç”¨ç¨‹åºã€‚
### è§£é” Ledger è®¾å¤‡å¹¶æ‰“å¼€ Aptos åº”ç”¨ç¨‹åºã€‚

   <Callout type="info" emoji="â„¹ï¸">
   æ¯å½“ä½ æƒ³ä½¿ç”¨ Ledger ç­¾ç½²æ—¶ï¼Œéƒ½éœ€è¦æ’å…¥è®¾å¤‡ã€è§£é”å®ƒå¹¶åœ¨è¿è¡Œä»»ä½• CLI å‘½ä»¤ä¹‹å‰æ‰“å¼€ Aptos åº”ç”¨ç¨‹åºã€‚
   </Callout>

### åœ¨ Aptos CLI ä¸­åˆ›å»ºæ–°çš„ Ledger é…ç½®æ–‡ä»¶

   ```bash filename="Terminal"
   aptos init --profile <ä½ çš„é…ç½®æ–‡ä»¶> --ledger
   ```

   ç„¶åæŒ‰ç…§ç»ˆç«¯æç¤ºæ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

   ```text filename="Terminal"
   Configuring for profile <ä½ çš„é…ç½®æ–‡ä»¶>
   Choose network from [devnet, testnet, mainnet, local, custom | defaults to devnet]

   No network given, using devnet...
   Please choose an index from the following 5 ledger accounts, or choose an arbitrary index that you want to use:
   [0] Derivation path: m/44'/637'/0'/0'/0' (Address: 59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb)
   [1] Derivation path: m/44'/637'/1'/0'/0' (Address: 21563230cf6d69ee72a51d21920430d844ee48235e708edbafbc69708075a86e)
   [2] Derivation path: m/44'/637'/2'/0'/0' (Address: 667446181b3b980ef29f5145a7a2cc34d433fc3ee8c97fc044fd978435f2cb8d)
   [3] Derivation path: m/44'/637'/3'/0'/0' (Address: 2dcf037a9f31d93e202c074229a1b69ea8ee4d2f2d63323476001c65b0ec4f31)
   [4] Derivation path: m/44'/637'/4'/0'/0' (Address: 23c579a9bdde1a59f1c9d36d8d379aeefe7a5997b5b58bd5a5b0c12a4f170431)

   0
   Account 59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb has been already found on-chain

   ---
   Aptos CLI is now set up for account 59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb as profile <ä½ çš„é…ç½®æ–‡ä»¶>!  Run `aptos --help` for more information about commands
   {
     "Result": "Success"
   }
   ```

   åœ¨ç¤ºä¾‹ä¸­ï¼Œä»–ä»¬é€‰æ‹©ä½¿ç”¨ç¬¬ä¸€ä¸ª ledger è´¦æˆ·ï¼Œåœ¨ `aptos init` å‘½ä»¤åè¾“å…¥ `0`ã€‚ä½ å¯ä»¥é€‰æ‹©ä»»ä½•ä½ æƒ³è¦çš„è´¦æˆ·ã€‚

   **å¸¸è§é”™è¯¯ï¼š**

   1. å¦‚æœä½ çœ‹åˆ°é”™è¯¯ `Device Not Found`ï¼Œè¯·ç¡®ä¿è§£é”ä½ çš„ Ledger ç„¶åé‡è¯•æ­¤æ­¥éª¤ã€‚
   2. å¦‚æœä½ çœ‹åˆ°é”™è¯¯ `Aptos ledger app is not opened`ï¼Œè¯·ç¡®ä¿åœ¨ä½ çš„ Ledger ä¸Šæ‰“å¼€ Aptos åº”ç”¨ç¨‹åºï¼Œç„¶åé‡è¯•æ­¤æ­¥éª¤ã€‚

### æœ€åï¼Œä½ éœ€è¦æŒ‰ç…§[è¿™äº›æ­¥éª¤](https://medium.com/@DavidLehman24/how-to-enable-disable-blind-signing-on-ledger-wallet-99113a85cdad)åœ¨ Ledger è®¾å¤‡ä¸Šå¯ç”¨ç›²ç­¾åã€‚
   1. ç›²ç­¾åå…è®¸ä½ ç¡®è®¤æ— æ³•é€šè¿‡äººç±»å¯è¯»è¯­è¨€éªŒè¯çš„æ™ºèƒ½åˆçº¦äº¤äº’ã€‚
   2. è¿™æ˜¯æ‰§è¡Œäº¤æ˜“æ‰€å¿…éœ€çš„ï¼Œå› ä¸ºæŸäº›æœ‰æ•ˆè´Ÿè½½å¤ªå¤§è€Œæ— æ³•æ˜¾ç¤ºã€‚
</Steps>

## ä½¿ç”¨ Ledger ç­¾ç½²

å®Œæˆåˆå§‹è®¾ç½®åï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ç­¾ç½²äº¤æ˜“ï¼š

1. æ’å…¥ä½ çš„ ledgerã€‚
2. è§£é”å®ƒã€‚
3. æ‰“å¼€ Aptos åº”ç”¨ç¨‹åºã€‚
4. è¿è¡Œéœ€è¦ç­¾åçš„ Aptos CLI å‘½ä»¤ã€‚

<Callout type="info" emoji="â„¹ï¸">
è¿™ä¸ªè¿‡ç¨‹é€‚ç”¨äºä»»ä½•éœ€è¦ç­¾åçš„å‘½ä»¤ï¼Œæ— è®ºæ˜¯è½¬ç§»ä»£å¸ã€å‘å¸ƒ Move åˆçº¦è¿˜æ˜¯ä¸åˆçº¦äº¤äº’ç­‰ã€‚
</Callout>

ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³å‘å¸ƒåƒ `[hello_blockchain](https://github.com/aptos-labs/aptos-core/tree/main/aptos-move/move-examples/hello_blockchain)` æ¼”ç¤ºåˆçº¦è¿™æ ·çš„ Move åŒ…ï¼Œä½ å¯ä»¥æŒ‰ç…§ä¸Šè¿°æ­¥éª¤ç„¶åè¿è¡Œï¼š

```bash filename="Terminal"
aptos move publish --profile <ä½ çš„-ledger-é…ç½®æ–‡ä»¶åç§°> --named-addresses hello_blockchain=<ä½ çš„-ledger-é…ç½®æ–‡ä»¶åç§°>
```

ä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å“åº”ï¼š

```bash filename="Terminal"
Compiling, may take a little while to download git dependencies...
INCLUDING DEPENDENCY AptosFramework
INCLUDING DEPENDENCY AptosStdlib
INCLUDING DEPENDENCY MoveStdlib
BUILDING Examples
package size 1755 bytes
Do you want to submit a transaction for a range of [139600 - 209400] Octas at a gas unit price of 100 Octas? [yes/no] >

yes

{
  "Result": {
    "transaction_hash": "0xd5a12594f85284cfd5518d547d084030b178ee926fa3d8cbf699cc0596eff538",
    "gas_used": 1396,
    "gas_unit_price": 100,
    "sender": "59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb",
    "sequence_number": 0,
    "success": true,
    "timestamp_us": 1689887104333038,
    "version": 126445,
    "vm_status": "Executed successfully"
  }
}
```

åœ¨ä½ æ‰¹å‡†å‘å¸ƒæ­¤åŒ…åï¼Œç³»ç»Ÿä¼šæç¤ºä½ åœ¨ Ledger è®¾å¤‡ä¸Šç­¾ç½²äº¤æ˜“ã€‚ä¸€æ—¦ç­¾ç½²ï¼ŒåŒ…å°±ä¼šå‘å¸ƒåˆ°ç½‘ç»œï¼

ä½ å¯èƒ½é‡åˆ°çš„ä¸€ä¸ªé”™è¯¯æ˜¯ `Error: Wrong raw transaction length`ã€‚è¿™æ„å‘³ç€äº¤æ˜“æˆ–åŒ…çš„å¤§å°å¯¹ä½ çš„è®¾å¤‡æ¥è¯´å¤ªå¤§è€Œæ— æ³•ç­¾ç½²ã€‚ç›®å‰ Aptos Ledger åº”ç”¨ç¨‹åºåªèƒ½æ”¯æŒå°äº 20kb çš„äº¤æ˜“ã€‚`Ledger Nano S` è®¾å¤‡çš„å†…å­˜æ¯”è¿™è¿˜å°‘ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒæ›´å®¹æ˜“äº§ç”Ÿè¿™ä¸ªé”™è¯¯ã€‚

## èº«ä»½éªŒè¯å¯†é’¥è½®æ¢

å¦‚æœä½ æœ‰ä¸€ä¸ªæœªä½¿ç”¨ç¡¬ä»¶é’±åŒ…ä¿æŠ¤çš„æ´»è·ƒè´¦æˆ·ï¼Œé‚£ä¹ˆä½ å¯èƒ½å¸Œæœ›è½®æ¢è´¦æˆ·çš„èº«ä»½éªŒè¯å¯†é’¥ï¼Œä½¿å…¶å¯¹åº”äº Ledger ä¸ŠæŒæœ‰çš„ [BIP44 è´¦æˆ·ç´¢å¼•] ç§é’¥ã€‚

æˆ–è€…ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªä¸ Ledger ç¡¬ä»¶é’±åŒ…å…³è”çš„è´¦æˆ·ï¼Œä½ æƒ³ä»ä¸­å‘å¸ƒä¸€ä¸ªå¤§å‹åŒ…ï¼Œä½ å¯èƒ½æƒ³æš‚æ—¶å°†è´¦æˆ·çš„èº«ä»½éªŒè¯å¯†é’¥è½®æ¢åˆ°çƒ­å¯†é’¥ä»¥é¿å…å†…å­˜é—®é¢˜ã€‚

æœ¬æ•™ç¨‹å°†æŒ‡å¯¼ä½ å®Œæˆè¿™ä¸¤ç§æƒ…å†µã€‚

<Callout type="warning" emoji="â—">
åœ¨å¼€å§‹æœ¬æ•™ç¨‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²å®Œæˆ[å¯†é’¥è½®æ¢æŒ‡å—](../../guides/key-rotation.mdx)ã€‚
</Callout>

<Steps>

### å®Œæˆå¯†é’¥è½®æ¢æŒ‡å—

ç¡®è®¤ä½ å·²å®Œæˆ[å¯†é’¥è½®æ¢æŒ‡å—](../../guides/key-rotation.mdx)ã€‚

### éªŒè¯ä½ çš„ Ledger å·²å‡†å¤‡å°±ç»ª

1. è¿æ¥å¹¶è§£é”ä½ çš„ Ledgerã€‚
1. æ£€æŸ¥ä½ çš„ Aptos åº”ç”¨ç¨‹åºç‰ˆæœ¬ï¼š`Aptos > About > Version`ã€‚
1. å¦‚æœä½ æ²¡æœ‰ `0.6.9` æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨ Ledger Live æ›´æ–°å®ƒã€‚
1. å¯ç”¨ç›²ç­¾åï¼š`Aptos > Settings > Enable Blind Signing`ã€‚

### å¯åŠ¨æœ¬åœ°ç½‘ç»œ

å¯åŠ¨æœ¬åœ°ç½‘ç»œï¼š

```sh filename="Terminal"
aptos node run-localnet
```

å½“å®ƒæ‰“å°å‡ºä»¥ä¸‹å†…å®¹æ—¶ï¼Œæœ¬åœ°ç½‘ç»œå°±å‡†å¤‡å¥½äº†ï¼š

```sh filename="Terminal"
Applying post startup steps...

Setup is complete, you can now use the localnet!
```

<Callout type="info" emoji="ğŸ§ ">
å¦‚æœä½ æ˜¯ MacOS æˆ– Linux çš„é«˜çº§ç”¨æˆ·ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœ¨åå°è¿›ç¨‹ä¸­å¯åŠ¨ä¸€ä¸ªå…¨æ–°çš„æœ¬åœ°ç½‘ç»œï¼š

```sh filename="Terminal"
mkdir -p localnet-data
aptos node run-localnet \
    --assume-yes \
    --test-dir localnet-data \
    --force-restart &
export LOCALNET_PID=$!
```

ç„¶åä½ å¯ä»¥éšæ—¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åœæ­¢æœ¬åœ°ç½‘ç»œï¼š

```sh filename="Terminal"
kill $LOCALNET_PID
```
</Callout>

### è®¾ç½®æœ¬åœ°ç½‘ç»œçƒ­é’±åŒ…é…ç½®æ–‡ä»¶

åˆ›å»ºä¸€ä¸ªç§é’¥ï¼Œå¯¹åº”äºä»¥è™šè£å‰ç¼€ `0xaaa` å¼€å¤´çš„èº«ä»½éªŒè¯å¯†é’¥ï¼Œä»è€Œå¾—åˆ°åˆå§‹è´¦æˆ·åœ°å€ï¼š

```sh filename="Terminal"
aptos key generate \
    --assume-yes \
    --output-file private-key-a \
    --vanity-prefix 0xaaa
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": {
    "PublicKey Path": "private-key-a.pub",
    "PrivateKey Path": "private-key-a",
    "Account Address:": "0xaaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5"
  }
}
```
</details>

ä½¿ç”¨ç§é’¥åœ¨æœ¬åœ°ç½‘ç»œä¸Šåˆå§‹åŒ– `hot-wallet-1` é…ç½®æ–‡ä»¶ï¼š

```sh filename="Terminal"
aptos init \
    --assume-yes \
    --network local \
    --private-key-file private-key-a \
    --profile hot-wallet-1
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
Configuring for profile hot-wallet-1
Configuring for network Local
Using command line argument for private key
Account 0xaaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5 doesn\'t exist, creating it and funding it with 100000000 Octas
Account 0xaaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5 funded successfully

---
Aptos CLI is now set up for account 0xaaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5 as profile hot-wallet-1!  Run `aptos --help` for more information about commands
{
  "Result": "Success"
}
```
</details>

### è½®æ¢çƒ­é’±åŒ…å¯†é’¥

å°†çƒ­é’±åŒ…çš„èº«ä»½éªŒè¯å¯†é’¥è½®æ¢ä¸ºä½¿ç”¨ä½ çš„ Ledger ä¸Šçš„ [BIP44 è´¦æˆ·ç´¢å¼•] 1000ï¼š

```sh filename="Terminal"
aptos account rotate-key \
    --assume-yes \
    --new-derivation-index 1000 \
    --profile hot-wallet-1 \
    --save-to-profile ledger-wallet-1000
```

<Callout type="info" emoji="ğŸ§ ">
ä½œä¸ºæœ€ä½³å®è·µï¼Œæ­¤å‘½ä»¤ä½¿ç”¨ä»å¤§æ•°å­—ï¼ˆ1000ï¼‰å¼€å§‹çš„ [BIP44 è´¦æˆ·ç´¢å¼•]ï¼Œä»¥è¡¨æ˜è¯¥è´¦æˆ·æ˜¯ç”± Ledger ä¸Šçš„è½®æ¢èº«ä»½éªŒè¯å¯†é’¥ä¿æŠ¤çš„ï¼Œä»¥ç¡®ä¿å®ƒä¸ä¼šä¸ä»»ä½•å…¶ä»–ç°æœ‰è´¦æˆ·å†²çªã€‚

è¿™ç§åšæ³•æœ‰åŠ©äºé…ç½®æ–‡ä»¶æ¢å¤ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚
</Callout>

æŒ‰ç…§ CLI æç¤ºçš„è¯´æ˜æ“ä½œï¼š

```sh filename="Terminal"
Approve rotation proof challenge signature on your Ledger device
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": {
    "message": "Saved new profile ledger-wallet-1000",
    "transaction": {
      "transaction_hash": "0x1a6df99651ac170bda10cfb9898fa196321d80a928033791b9d2231f77738bb2",
      "gas_used": 448,
      "gas_unit_price": 100,
      "sender": "aaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5",
      "sequence_number": 0,
      "success": true,
      "timestamp_us": 1717986382369736,
      "version": 186,
      "vm_status": "Executed successfully"
    }
  }
}
```
</details>

æ¯”è¾ƒ `hot-wallet-1` å’Œ `ledger-wallet-1000` é…ç½®æ–‡ä»¶ï¼Œæ³¨æ„å®ƒä»¬æœ‰ç›¸åŒçš„ `account` åœ°å€ä½†ä¸åŒçš„ `public_key` å€¼ï¼š

```sh filename="Terminal"
aptos config show-profiles --profile hot-wallet-1
aptos config show-profiles --profile ledger-wallet-1000
```
</Steps>

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": {
    "hot-wallet-1": {
      "has_private_key": true,
      "public_key": "0xffb1240fd1267207cc3ed2e1b5386e090a9ca2c844d7f9e0077b3d7dd5d5e430",
      "account": "aaa271bca468fb8518f73a732a484b29a1bc296ebcb23f15639d4865a5cebe87",
      "rest_url": "http://localhost:8080",
      "faucet_url": "http://localhost:8081"
    }
  }
}
{
  "Result": {
    "ledger-wallet-1000": {
      "has_private_key": false,
      "public_key": "0x20ba83f9b9fdab73b0ace8fda26ce24c98cf55060b72b69cfbd25add6a25d09b",
      "account": "aaa271bca468fb8518f73a732a484b29a1bc296ebcb23f15639d4865a5cebe87",
      "rest_url": "http://localhost:8080",
      "faucet_url": "http://localhost:8081"
    }
  }
}
```
</details>

ç”±äºè¯¥è´¦æˆ·ä¸å†ç”±çƒ­ç§é’¥ä¿æŠ¤ï¼Œè¯·åˆ é™¤ç§é’¥å’Œå…¬é’¥æ–‡ä»¶ã€‚

<Callout type="info" emoji="ğŸ§ ">
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç±» UNIX æœºå™¨ï¼š

```shell filename="Terminal"
rm private-key-a
rm private-key-b
rm private-key-a.pub
rm private-key-b.pub
```
</Callout>

ç°åœ¨ä½ å·²ç»æˆåŠŸè½®æ¢äº†çƒ­é’±åŒ…çš„èº«ä»½éªŒè¯å¯†é’¥ï¼Œä½ ä¹Ÿå¯ä»¥åˆ é™¤è¿™äº›é…ç½®æ–‡ä»¶ï¼š

```sh filename="Terminal"
aptos config delete-profile --profile hot-wallet-1
aptos config delete-profile --profile ledger-wallet-1000
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": "Deleted profile hot-wallet-1"
}
{
  "Result": "Deleted profile ledger-wallet-1000"
}
```
</details>

### æ¢å¤é…ç½®æ–‡ä»¶

ç”±äºä½ çŸ¥é“ä½ å°†çƒ­é’±åŒ…çš„èº«ä»½éªŒè¯å¯†é’¥è½®æ¢åˆ°äº† Ledgerï¼Œå¹¶ä¸”ä½ ä½¿ç”¨äº†æœ€ä½³å®è·µçš„ [BIP44 è´¦æˆ·ç´¢å¼•] åç§»é‡ 1000ï¼Œä½ å¯ä»¥ä»…ä½¿ç”¨ [BIP44 è´¦æˆ·ç´¢å¼•] è½»æ¾æ¢å¤é…ç½®æ–‡ä»¶ï¼š

```sh filename="Terminal"
aptos init \
    --assume-yes \
    --derivation-index 1000 \
    --network local \
    --profile ledger-wallet-1000-recovered
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
Configuring for profile ledger-wallet-1000-recovered
Configuring for network Local
Account 0xaaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5 has been already found onchain

---
Aptos CLI is now set up for account 0xaaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5 as profile ledger-wallet-1000-recovered!  Run `aptos --help` for more information about commands
{
  "Result": "Success"
}
```
</details>

æ³¨æ„æ­¤é…ç½®æ–‡ä»¶å¯¹åº”äºæŒ‡å®šçš„ `0xaaa...` è™šè£åœ°å€ï¼š

```sh filename="Terminal"
aptos config show-profiles --profile ledger-wallet-1000-recovered
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": {
    "ledger-wallet-1000-recovered": {
      "has_private_key": false,
      "public_key": "0x20ba83f9b9fdab73b0ace8fda26ce24c98cf55060b72b69cfbd25add6a25d09b",
      "account": "aaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5",
      "rest_url": "http://localhost:8080",
      "faucet_url": "http://localhost:8081"
    }
  }
}
```
</details>

<Callout type="info" emoji="ğŸ§ ">
`aptos init` å‘½ä»¤é¦–å…ˆæ£€æŸ¥ [`account::OriginatingAddress`] è¡¨ä»¥ç¡®å®šä¸å…¬é’¥å…³è”çš„è´¦æˆ·åœ°å€ï¼Œå› æ­¤åªè¦ä½ éµå¾ª[å¯†é’¥è½®æ¢æŒ‡å—](../../guides/key-rotation.mdx)ä¸­çš„æœ€ä½³å®è·µï¼Œå¹¶ä¸”ä¸€æ¬¡åªä½¿ç”¨ä¸€ä¸ªç§é’¥éªŒè¯ä¸€ä¸ªè´¦æˆ·ï¼Œä½ å°±å¯ä»¥ä»…åŸºäº [BIP44 è´¦æˆ·ç´¢å¼•] è½»æ¾æ¢å¤ä½ çš„é…ç½®æ–‡ä»¶ã€‚
</Callout>

### è½®æ¢åˆ°æ–°çš„çƒ­ç§é’¥

å¦‚æœä½ æœ‰ä¸€ä¸ªä¸ Ledger ç¡¬ä»¶é’±åŒ…å…³è”çš„è´¦æˆ·ï¼Œä½ æƒ³ç”¨å®ƒæ¥å‘å¸ƒä¸€ä¸ªå¤§å‹åŒ…ï¼Œç”±äº Ledger çš„å†…å­˜é™åˆ¶ï¼Œä½ å°†æ— æ³•ç­¾ç½²åŒ…å‘å¸ƒäº¤æ˜“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦æš‚æ—¶è½®æ¢åˆ°çƒ­é’±åŒ…ã€‚

é¦–å…ˆç”Ÿæˆä¸€ä¸ªæ–°çš„ç§é’¥ï¼š

```sh filename="Terminal"
aptos key generate \
    --assume-yes \
    --output-file private-key-b \
    --vanity-prefix 0xbbb
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": {
    "PublicKey Path": "private-key-b.pub",
    "PrivateKey Path": "private-key-b",
    "Account Address:": "0xbbbede2b4f1d49eff0b156ab0756889a6f2bb68f215399d5015da9ac45921b47"
  }
}
```
</details>

å°†ä¸ Ledger å…³è”çš„è´¦æˆ·çš„èº«ä»½éªŒè¯å¯†é’¥è½®æ¢åˆ°æ–°çš„ç§é’¥ï¼š

```sh filename="Terminal"
aptos account rotate-key \
    --assume-yes \
    --new-private-key-file private-key-b \
    --profile ledger-wallet-1000-recovered \
    --save-to-profile temporary-hot-wallet
```

æŒ‰ç…§ CLI æç¤ºçš„è¯´æ˜æ“ä½œï¼š

```sh filename="Terminal"
Approve rotation proof challenge signature on your Ledger device
```

```sh filename="Terminal"
Approve transaction on your Ledger device
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": {
    "message": "Saved new profile temporary-hot-wallet",
    "transaction": {
      "transaction_hash": "0xe49782e92d8fd824fd6dce8f6ed42a11cf8ee84c201f3aa639c435e737c80eaa",
      "gas_used": 449,
      "gas_unit_price": 100,
      "sender": "aaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5",
      "sequence_number": 1,
      "success": true,
      "timestamp_us": 1717986617911082,
      "version": 631,
      "vm_status": "Executed successfully"
    }
  }
}
```
</details>

ç”±äº CLI é…ç½®æ–‡ä»¶ `ledger-wallet-1000-recovered` ç°åœ¨å·²è¿‡æ—¶ï¼Œè¯·é‡å‘½åå®ƒï¼Œä»¥é˜²ä½ ä¸­æ–­å¹¶å¿˜è®°ç§é’¥å·²è¢«è½®æ¢ï¼š

```sh filename="Terminal"
aptos config rename-profile \
    --profile ledger-wallet-1000-recovered \
    --new-profile-name ledger-wallet-1000-stale
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": "Renamed profile ledger-wallet-1000-recovered to ledger-wallet-1000-stale"
}
```
</details>

### è½®æ¢å› Ledger

ä¸€æ—¦ä½ ç”¨çƒ­å¯†é’¥ç­¾ç½²äº†å¤§å‹åŒ…å‘å¸ƒäº¤æ˜“ï¼Œä½ å°±å¯ä»¥å°†èº«ä»½éªŒè¯å¯†é’¥è½®æ¢å›å¯¹åº”äº Ledger ä¸Šç´¢å¼• 1000 çš„ç§é’¥ï¼š

```sh filename="Terminal"
aptos account rotate-key \
    --assume-yes \
    --new-derivation-index 1000 \
    --profile temporary-hot-wallet \
    --save-to-profile ledger-wallet-1000
```

æŒ‰ç…§ CLI æç¤ºçš„è¯´æ˜æ“ä½œï¼š

```sh filename="Terminal"
Approve rotation proof challenge signature on your Ledger device
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": {
    "message": "Saved new profile ledger-wallet-1000",
    "transaction": {
      "transaction_hash": "0x9503819d4ea13bcd9eafed25984807d86d22e8a9837565a7495b54d13890d103",
      "gas_used": 449,
      "gas_unit_price": 100,
      "sender": "aaac71af5f2a4af4ec2639a15799bf9b945afb061c8bee102b636531c1b00eb5",
      "sequence_number": 2,
      "success": true,
      "timestamp_us": 1717986672963544,
      "version": 742,
      "vm_status": "Executed successfully"
    }
  }
}
```
</details>

éªŒè¯ `ledger-wallet-1000-stale` å’Œ `ledger-wallet-1000` é…ç½®æ–‡ä»¶å…·æœ‰ç›¸åŒçš„ `account` åœ°å€å’Œ `public_key`ï¼š

```sh filename="Terminal"
aptos config show-profiles --profile ledger-wallet-1000-stale
aptos config show-profiles --profile ledger-wallet-1000
```

åˆ é™¤ä½ ä¸å†éœ€è¦çš„ `temporary-hot-wallet` å’Œ `ledger-wallet-1000-stale` é…ç½®æ–‡ä»¶ã€‚

```sh filename="Terminal"
aptos config delete-profile --profile temporary-hot-wallet
aptos config delete-profile --profile ledger-wallet-1000-stale
```

<details>
<summary>ç¤ºä¾‹è¾“å‡º</summary>
```sh filename="Terminal"
{
  "Result": "Deleted profile temporary-hot-wallet"
}
{
  "Result": "Deleted profile ledger-wallet-1000-stale"
}
```
</details>

ç”±äºä½ ä¸å†éœ€è¦ä¸´æ—¶ç§é’¥ï¼Œä¹Ÿè¯·åˆ é™¤å®ƒã€‚

<Callout type="info" emoji="ğŸ§ ">
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç±» UNIX æœºå™¨ï¼š

```shell filename="Terminal"
rm private-key-*
```
</Callout>

### æ¸…ç†

åˆ é™¤å‰©ä½™çš„æµ‹è¯•é…ç½®æ–‡ä»¶ï¼š

```shell filename="Terminal"
aptos config delete-profile --profile ledger-wallet-1000
```

ç„¶ååœæ­¢æœ¬åœ°ç½‘ç»œã€‚

<Callout type="info" emoji="ğŸ§ ">
å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ç±» UNIX æœºå™¨ï¼š

```shell filename="Terminal"
aptos config delete-profile --profile ledger-wallet-1000
kill $LOCALNET_PID
rm -fr localnet-data
```
</Callout>

</Steps>

[`account::OriginatingAddress`]: https://github.com/aptos-labs/aptos-core/blob/acb6c891cd42a63b3af96561a1aca164b800c7ee/aptos-move/framework/aptos-framework/sources/account.move#L70
[BIP44 è´¦æˆ·ç´¢å¼•]: https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki 